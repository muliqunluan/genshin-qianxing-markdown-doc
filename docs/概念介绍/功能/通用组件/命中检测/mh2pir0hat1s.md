# mh2pir0hat1s

## 一、命中检测组件的功能命中检测组件可以在组件内定义的命中区域碰到其他实体或场景地形（以及水面）时，向服务端节点图发送命中事件，多数情况下可以用于承担

一个投射物攻击盒的功能也可以在命中区域碰到其他实体时，从本地立刻发起一次能力单元的调用（仅限攻击）命中检测组件可支持同时生效多个命中检测区域，他们的生效范围会进行叠加。一个常见的用法是将命中检测组件用作投射物的命中判定盒，即通过命中检测组件来判定投射物的命中，并在投射物的节点图中处理命中后执行的事件（例如：造成伤害、播放特效等）

## 二、命中检测组件的编辑

### 1.添加组件

#### (1)在实体/元件编辑界面中，打开组件编辑页签

#### (2)点击下方的“添加通用组件”，选择并点击“命中检测”，成功添加

#### (3)点击“详细编辑”，展开编辑页

### 2.命中规则的编辑各个参数功能如下：参数功能触发类型单次触发：在组件的整个生命周期中，命中检测仅触发一次。即在整个生命周期内最多向节点图发送一次命中事件不重复触发：对于每个命中的实体，命中检测最多触发一次重复触发：可以多次重复触发，受到触发间隔的限制，每次触发后都需要等触发间隔的时间后再次触发触发间隔仅触发类型为重复触发时可配置检测延迟时间当实体被创建时，会延迟【检测延迟时间】所配置的时间再开始命中检测。常见用途是防止投射物类的物件在射出时命中发射者自身开启连续碰撞检测打开后，开启命中检测的连续碰撞检测（CCD）功能连续碰撞检测：当运动的实体处于高速运动时，常规碰撞机制会因为前后两帧位置差距过大导致出现“隧穿”现象（即实体穿过被碰撞的目标但没有触发碰撞），在开启连续碰撞检测后，会使高速运动下的实体碰撞更加精确连续碰撞检测有较高的性能开销，因此仅推荐在适用的情景（高速运动且需要精确命中）下使用连续碰撞检测类型速度超过阈值：当投射物的速度超过阈值时才启用CCD，有助于优化性能持续生效：始终生效，对性能消耗较高速度阈值仅CCD类型为速度超过阈值时有效，投射物的速度高于该值时才会开启CCD，有助于优化性能检测半径连续碰撞检测通过在前后帧位置之间生成一个一定半径的圆柱体辅助碰撞检测实现，检测半径决定了这个圆柱体的半径，推荐与投射物的实际半径保持一致。当值为0时，使用射线进行检测过滤器节点图可引用本地过滤器节点图，用于判断当次命中是否生效。两种过滤器的具体区分和使用请看若筛选和本地过滤器一同使用，需要同时满足，才算做命中生效本地过滤器会在每次命中发生时，执行一次对应本地过滤器节点图中的基础节点，进行说明获取自身实体输出参数为投射物实体获取目标实体输出参数为在命中的实体获取当前角色输出参数为本地角色本地过滤器举例说明启用下方筛选开启后，启用下方的筛选参数。未开启时则视为没有进行筛选，会命中所有可以通过过滤器的实体阵营筛选无：不命中任何阵营的实体敌对阵营：只命中与投射物敌对的阵营友善阵营：只命中与投射物友善的阵营，不包含自身友善阵营包含自身实体：只命中与投射物友善的阵营，包含自身自身阵营：只命中投射物所在的阵营所有阵营：命中所有阵营，包含自身所有阵营排除自身实体：命中所有阵营，不包含自身实体类型筛选可以复选的选项，包括：物件、角色和造物命中层筛选可以复选的选项，当选中多个选项时，可能会发生多次命中（例如命中一个带有受击盒的物件时，可能因为命中物件自身碰撞和受击盒发生两次命中事件）受击盒：只命中带有受击盒的实体场景：命中场景的碰撞，此时节点图中命中检测触发时节点的是否命中受击盒的值为否物件自身碰撞：命中物件自身的碰撞引发命中检测，注意此时节点图中命中检测触发时的是否命中受击盒的值为否，且不会返回命中实体命中时执行能力单元引用一组能力单元，见当命中检测触发时，会触发这一组能力单元

### 3.命中区域的编辑点击【添加触发区】新增一个命中区域配置命中检测区域与的配置类似，检测区域可以配置多个，当任意一个检测区域碰撞到实体或场景时，都会触发命中检测事件参数功能触发区形状目前支持长方体、球体和胶囊体检测区域中心相对实体或元件中心的偏移旋转仅选择长方体区域时可配置，长方体检测区域的旋转欧拉角缩放倍率仅选择长方体区域时可配置，对长方体的长宽高进行缩放半径球体的半径/胶囊体的半径角度仅选择胶囊体区域时可配置，胶囊体的角度高度仅选择胶囊体区域时可配置，胶囊体的高度

## 三、在节点图中使用命中检测相关功能命中检测触发时节点类型：事件

#### 节点功能

当命中检测组件碰撞到实体或场景时，会向组件拥有者的节点图推送【投射物命中时】事件根据命中检测组件中【触发类型】的配置，该事件可能触发

一次或多次

#### 节点参数

| 参数类型 | 参数名 | 类型 | 说明 |
| --- | --- | --- | --- |
| 出参 | 事件源 | 实体 | 实体事件通用参数，事件触发者的实体 |
| 出参 | 事件源 | GUID | GUID事件通用参数，事件触发者的GUID |
| 出参 | 是否命中受击盒 | 布尔值 | 返回是否命中实体的受击盒。命中实体受击盒时，返回【是】，命中场景或自身碰撞时，返回【否】 |
| 出参 | 命中 | 实体 | 实体当命中实体受击盒时，返回命中的实体。命中场景或自身碰撞时，返回空 |
| 出参 | 命中位置 | 三维向量 | 返回命中位置，不论是否命中到实体 |
